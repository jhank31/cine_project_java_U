package project.uniquindio.cine.views;

import java.awt.EventQueue;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JSpinner;
import javax.swing.JTextField;
import javax.swing.SpinnerNumberModel;
import javax.swing.border.EmptyBorder;

import project.uniquindio.cine.models.ModelMovie;
import project.uniquindio.cine.models.ModelUser;

import java.awt.GridBagLayout;


import javax.swing.JButton;
import java.awt.event.ActionListener;
import java.time.LocalDate;
import java.util.ArrayList;
import java.awt.event.ActionEvent;

import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.ImageIcon;
import javax.swing.SwingConstants;
import javax.swing.JComboBox;
import javax.swing.JToggleButton;



public class ViewMovies extends JFrame implements ActionListener  {
	

	private JPanel contentPane;
	private ModelMovie asignarPelicula;
	private ModelUser datosPersona;
	
	
	LocalDate fechahoy = LocalDate.now();
	private JTextField textFieldIngresoCedula;
	private JButton capturar;
	private JLabel txtNombrePersona;
	private JButton buttomRecargar;
	private JButton buttomRegistrarse;
	String datoTextField;
	String nombre = "";
	int saldoActual;
	JButton ButtomBuscar;
	JComboBox comboBoxDiaSeleccionado;
	static String datoCedulaPerson;
	String datoNombrePerson;
    JLabel txtPelicula1;
    String diaSeleccionado;
    static String horaPelicula;
    
    static String nombrePelicula;



	
	public ViewMovies(String datoCedula, String datoNombre) {
		setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
		
		datoCedulaPerson = datoCedula;
		datoNombrePerson = datoNombre;
		asignarPelicula = new ModelMovie();
		datosPersona = new ModelUser();
		setResizable(false);
		setSize(500,500);
		setBounds(250, 50, 1000, 780);
		contentPane = new JPanel();
		contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
		setContentPane(contentPane);
		contentPane.setLayout(null);
		
		

		GridBagLayout gbl_contentPane = new GridBagLayout();
		gbl_contentPane.columnWidths = new int[]{0, 0, 0, 0, 0, 0, 0, 0};
		gbl_contentPane.rowHeights = new int[]{0, 0, 0, 0, 0, 0, 0};
		gbl_contentPane.columnWeights = new double[]{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, Double.MIN_VALUE};
		gbl_contentPane.rowWeights = new double[]{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, Double.MIN_VALUE};
       
			
		
			getPeli(((ArrayList<?>) asignarPelicula.getFuncions().get(0)).get(4), ((ArrayList<?>) asignarPelicula.getFuncions().get(0)).get(3).toString(),  ((ArrayList<?>) asignarPelicula.getFuncions().get(0)).get(1).toString());
			getPeli(((ArrayList<?>) asignarPelicula.getFuncions().get(1)).get(4), ((ArrayList<?>) asignarPelicula.getFuncions().get(1)).get(3).toString(),  ((ArrayList<?>) asignarPelicula.getFuncions().get(1)).get(1).toString());
			getPeli(((ArrayList<?>) asignarPelicula.getFuncions().get(2)).get(4), ((ArrayList<?>) asignarPelicula.getFuncions().get(2)).get(3).toString(),  ((ArrayList<?>) asignarPelicula.getFuncions().get(2)).get(1).toString());
		
		
			

		getAccionesCliente(fechahoy, datoCedula, datoNombre);
	    
}
	
	

	public void getPeli(Object image, String texto, String posicion) {
		
		
		
		JButton ButtonPelicula = new JButton();
		ButtonPelicula.setIcon(new ImageIcon("imagenes/"+image+""));
		ButtonPelicula.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				
				if(nombre == "") {
					JOptionPane.showMessageDialog(null, "Inicia Sesion Primero");
				
				}else {
					
					if (posicion.equals("0") ) {
						
						horaPelicula = asignarPelicula.getFuncions().get(0).get(2);
						nombrePelicula = asignarPelicula.getFuncions().get(0).get(5);
						
					} else if(posicion.equals("1")) {
						horaPelicula = asignarPelicula.getFuncions().get(1).get(2);
						nombrePelicula = asignarPelicula.getFuncions().get(1).get(5);
					} else {
						horaPelicula = asignarPelicula.getFuncions().get(2).get(2);
						nombrePelicula =  asignarPelicula.getFuncions().get(2).get(5);
					}
					
					ViewSeleccionSillas ventanaSillas = new ViewSeleccionSillas( posicion, datoTextField);
					ventanaSillas.setVisible(true);								
					
				}
			}
		});
		ButtonPelicula.setBounds(59, 129, 250, 310);
		contentPane.add(ButtonPelicula);
		 txtPelicula1 = new JLabel( "<html><p>" + texto + "</p></html>");
		txtPelicula1.setVerticalAlignment(SwingConstants.TOP);
		
		
		if (posicion.equals("0") ) {
			ButtonPelicula.setBounds(59, 129, 250, 310);
			txtPelicula1.setBounds(59, 451, 266, 160);
		} else if(posicion.equals("1")) {
			txtPelicula1.setBounds(382, 451, 242, 176);
			ButtonPelicula.setBounds(382, 129, 242, 310);
		} else {
			ButtonPelicula.setBounds(691, 129, 250, 310);
			txtPelicula1.setBounds(691, 451, 250, 190);
		}
		contentPane.add(txtPelicula1);
		
	}
	
	
       
	
		
		
		public void getAccionesCliente(LocalDate fechahoy,String datoCedula, String datoNombre) {

			JLabel TxtCliente = new JLabel("Cliente");
			TxtCliente.setBounds(48, 659, 61, 16);
			contentPane.add(TxtCliente);
			
			
		
			textFieldIngresoCedula = new JTextField(datoCedula);
			
			textFieldIngresoCedula.setBounds(135, 645, 142, 39);
			contentPane.add(textFieldIngresoCedula);
			
			
			capturar = new JButton("OK");
			capturar.addActionListener(this);
			capturar.setBounds(289, 657, 72, 23);
			contentPane.add(capturar);
			
			 txtNombrePersona = new JLabel(datoNombre);
			txtNombrePersona.setBounds(394, 659, 194, 16);
			contentPane.add(txtNombrePersona);
			
			
			
			buttomRecargar = new JButton("Recargar");
			buttomRecargar.addActionListener(this);
			buttomRecargar.setBounds(600, 645, 117, 46);
			contentPane.add(buttomRecargar);
			
			
			JLabel txtNoTienesCuenta = new JLabel("Â¿No tienes Cuenta Aun?");
			txtNoTienesCuenta.setBounds(76, 704, 179, 16);
			contentPane.add(txtNoTienesCuenta);
		
			
			buttomRegistrarse = new JButton("Registrarse");
			buttomRegistrarse.addActionListener(this);
				
			buttomRegistrarse.setBounds(226, 699, 117, 29);
			contentPane.add(buttomRegistrarse);
			
			
			
			
			JLabel txtFecha = new JLabel(fechahoy.toString());
			txtFecha.setBounds(37, 37, 72, 16);
			contentPane.add(txtFecha);
			
			comboBoxDiaSeleccionado = new JComboBox();

			comboBoxDiaSeleccionado.setBounds(99, 33, 80, 27);
			contentPane.add(comboBoxDiaSeleccionado);
			
			
			 ButtomBuscar = new JButton("Buscar");
			ButtomBuscar.setBounds(191, 32, 80, 29);
			 ButtomBuscar.addActionListener(this);
			contentPane.add(ButtomBuscar);
			
			 
			
			
			
			comboBoxDiaSeleccionado.addItem("21");
			comboBoxDiaSeleccionado.addItem("22");
			comboBoxDiaSeleccionado.addItem("23");
			
			
			
			
			
		}
		
		
		
		
		
	@Override
	public void actionPerformed(ActionEvent e) {
		
		
		if (e.getSource() == ButtomBuscar) {	
		   diaSeleccionado = (String) comboBoxDiaSeleccionado.getSelectedItem();
		   
		}
	
		
		
		
		if (e.getSource()== capturar) {
			
			datoTextField = textFieldIngresoCedula.getText();
			if(datosPersona.estaEnBaseDatos(datoTextField.trim())) {
				
				
             nombre	= datosPersona.getName(datoTextField.trim() );
             txtNombrePersona.setText(nombre);
             
             
             saldoActual = datosPersona.getSaldo(datoTextField.trim());
             
                 
             
             
			    JOptionPane.showMessageDialog(null, "Inicio Sesion Correcto");


			}else {
				
				datoTextField = "";
				textFieldIngresoCedula.setText(datoTextField);
				txtNombrePersona.setText(nombre);
				nombre = "";
				saldoActual = 0;
				JOptionPane.showMessageDialog(null, "No Tienes Cuenta, Create Una");
				
				
			}
		}
		
		
		if (e.getSource()== buttomRecargar) {
			
			if(nombre == "") {
				JOptionPane.showMessageDialog(null, "Inicia Sesion Primero");
			
			}else {
				
				Ventana_Recargar_View ventanaRecargar  = new 	Ventana_Recargar_View(datoTextField, nombre,saldoActual);
				ventanaRecargar.setVisible(true);
				
			}
			
			
		
		
		}
		
		if (e.getSource()== buttomRegistrarse) {
			
			Ventana_Registrarse_View ventanaRegistrarse = new Ventana_Registrarse_View();
			ventanaRegistrarse.setVisible(true);
		
			
			
		}
		
		
		
		
		
		
		
		
		
		
		
	}
}

